## 场景
[[Hybrid混合开发|Hybrid]] 开发时，需要上传服务器，webView 才能读到。能不能在原生 app 加载线上 h 5 时，跑本地的代码呢？答案是可以的，通过抓包工具比如 whistle 就可以做到拦截 app 线上页面请求数据，转发到电脑上的本地 web 服务器，本文主要讲述抓包的原理和抓包工具 whistle 使用。

## HTTP 抓包原理
思路就是设置一个中间人进程负责抓包，每次目标进程之间的会话都先与中间人进程通信，再进行转发。
对于 HTTP 抓包，无需做过多的处理，只需要让中间人负责转发客户端和服务端的数据包。

## HTTPS 抓包原理
前置知识： [[x5Web基础/计算机网络/HTTPS]]
中间人充当客户端的服务端、服务端的客户端。其中很重要的一步是浏览器的根证书校验，CA 机构不可能随便给一个中间人签发不属于它的域名证书，也就不在客户端的操作系统上了，因此只能把中间人的根证书，导入到客户端的操作系统了，以此完成建立加密通信时对中间人证书的验证。

## 电脑抓手机的包
PC 端建立一个服务器中间人进程，伪装为 web 应用的目标服务器。手机端 web 应用发送的请求数据先经过中间人，中间人进行拦截处理再发送给目标服务器。反过来，目标服务器发送的数据包先通过中间人，再由中间人响应给浏览器客户端。

1. 在 PC 电脑本地起一个服务器进程，监听一个端口比如 8899
2. 在手机上连接同一个局域网，配置网络代理 (如 vpn)，指向 PC 端的 IP 地址和 8899 端口
3. 这样一来，手机上所有的网络通信都会被先转发到 PC 端的 8899 端口，就可以对数据包进行分析处理

## 抓包工具 whistle
Whistle 是基于 Node 实现的跨平台抓包免费调试工具。
```
npm i -g whistle
w2 start
配置全局代理，端口8899
w2 proxy 
```
手机安装证书
访问 8899 查看抓包。

## 案例
[前端人必须掌握的抓包技能 - 掘金](https://juejin.cn/post/7140040425129115684?utm_source=ug_by_post#heading-10)
[前端人抓包羊了个羊，玩一次就过关 - 掘金](https://juejin.cn/post/7145256312488591391)


作者：jecyu
链接： https://juejin.cn/post/7140040425129115684
来源：稀土掘金
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。

作者：jecyu
链接： https://juejin.cn/post/7140040425129115684
来源：稀土掘金
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。

hybrid 开发是什么？