


JS 的脚本分为「加载、解析、执行」几个步骤 `fetch` (加载) 和 `execution` (解析并执行)。JS 的脚本加载(fetch)且执行(execution)会阻塞 DOM 的渲染

-   defer 加载(fetch)完成后延迟到 DOM 解析完成后才会执行(execution)**，但会在事件 `DomContentLoaded` 之前


关注分离设计思想（react 教学）

![[Pasted image 20230422112621.png]]
## http 请求
请求内容：
1. html。
1. css。
2. JavaScript。
3. image。

## Fetch API
更改选中诗歌
```
const verseChoose = document.querySelector("select");
const poemDisplay = document.querySelector("pre");

verseChoose.addEventListener("change", () => {
  const verse = verseChoose.value;
  updateDisplay(verse);
});

function updateDisplay(verse) {
	verse = verse.replace(" ", "").toLowerCase();
	const url = `${verse}.txt`;
	// 调用 `fetch()`，传入 URL。
	fetch(url)
	  .then((response) => {
	    if (!response.ok) {
	      throw new Error(`HTTP 错误：${response.status}`);
	    }
	    return response.text();
	  })
	  .then((text) => (poemDisplay.textContent = text))
	  .catch((error) => (poemDisplay.textContent = `获取诗歌失败：${error}`));
}

```

## XMLHttpRequest API
```
const request = new XMLHttpRequest();
// 初始化
request.open("GET", "products.json");
// 配置
request.responseType = "json";
request.addEventListener("load", () => initialize(request.response));
request.addEventListener("error", () => console.error("XHR error"));
// 发送
request.send();
```
> 我们还必须将整个事件包装在 try...catch 块中，以便处理 open() 或 send() 可能抛出的错误。
## 安全
如果只是使用本地文件运行示例，现代浏览器将不会执行 HTTP 请求。这是因为安全限制（更多关于 web 安全性的限制，请参阅网站安全）。

## 参考
[从服务器获取数据 - 学习 Web 开发 | MDN](https://developer.mozilla.org/zh-CN/docs/Learn/JavaScript/Client-side_web_APIs/Fetching_data)